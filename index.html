<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DNS Record Checker</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #fff;
      font-family: Arial, sans-serif;
    }

    .viewport { width: 100%; overflow-x: auto; }

    h2 { margin: 0 0 12px 0; font-size: 18px; font-weight: 700; text-align: center; }

    /* Table flexes to width of iframe */
    table {
      border-collapse: collapse;
      width: 100%;              /* use full width of iframe */
      table-layout: auto;       /* let columns shrink/grow as needed */
    }

    th, td {
      border: 1px solid #000;
      padding: 6px;
      text-align: center;
      font-size: 13px;
      word-break: break-word;   /* prevent long hostnames from overflowing */
    }

    thead th {
      background: #eee;
      font-weight: bold;
    }

    .status {
      margin-top: 10px;
      padding: 10px;
      text-align: center;
      color: #fff;
      font-weight: 700;
      font-size: 14px;
    }
    .ok  { background: #00a651; }
    .bad { background: #d50000; }
  </style>
</head>
<body>
  <div class="viewport">
    <h2 id="domain">DNS Record Confirmation</h2>
    <table>
      <thead>
        <tr>
          <th rowspan="2">DNS Record</th>
          <th colspan="2">Expected</th>
          <th colspan="2">Actual</th>
        </tr>
        <tr>
          <th>Value</th><th>Data</th><th>Value</th><th>Data</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>A</td>
          <td>@</td>
          <td id="expA"></td>
          <td>@</td>
          <td id="actA">—</td>
        </tr>
        <tr>
          <td>CNAME</td>
          <td id="cnameHostCell">www</td>
          <td id="expC"></td>
          <td id="actCnameHost">www</td>
          <td id="actC">—</td>
        </tr>
      </tbody>
    </table>
    <div id="status" class="status">Checking DNS…</div>
  </div>

  <script>
    const q = new URLSearchParams(location.search);
    const domain    = (q.get('domain')    || '').trim() || 'example.com';
    const expectedA = (q.get('expectedA') || '').trim() || '93.184.216.34';
    const expectedC = (q.get('expectedC') || '').trim() || 'example.com';
    const cnameHost = (q.get('cnameHost') || '').trim() || 'www';

    document.getElementById('domain').textContent = domain;
    document.getElementById('expA').textContent   = expectedA;
    document.getElementById('expC').textContent   = expectedC;
    document.getElementById('cnameHostCell').textContent = cnameHost;
    document.getElementById('actCnameHost').textContent  = cnameHost;

    async function doh(name, type) {
      const url = `https://cloudflare-dns.com/dns-query?name=${encodeURIComponent(name)}&type=${type}`;
      const res = await fetch(url, { headers: { accept:'application/dns-json' } });
      if (!res.ok) return [];
      const data = await res.json();
      return (data.Answer || []).map(a => a.data);
    }

    (async function run() {
      const statusEl = document.getElementById('status');
      try {
        const aAns = await doh(domain, 'A');
        const liveA = aAns.find(v => /^\d+\.\d+\.\d+\.\d+$/.test(v)) || 'N/A';
        document.getElementById('actA').textContent = liveA;

        const cAns = await doh(`${cnameHost}.${domain}`, 'CNAME');
        const liveC = cAns.length ? cAns[0].replace(/\.$/, '').toLowerCase() : 'N/A';
        document.getElementById('actC').textContent = liveC;

        const ok = (liveA === expectedA) &&
                   (liveC !== 'N/A' && liveC === expectedC.toLowerCase());
        statusEl.textContent = ok ? 'Your DNS Records are correct'
                                  : 'Your DNS Records are NOT correct';
        statusEl.className = 'status ' + (ok ? 'ok' : 'bad');
      } catch (e) {
        statusEl.textContent = 'Error checking DNS';
        statusEl.className = 'status bad';
      }
    })();
  </script>
</body>
</html>







