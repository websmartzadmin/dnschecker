<meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DNS Record Checker</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #fff;
      font-family: Arial, sans-serif;
    }
    html, body { margin:0; padding:0; background:#fff; font-family:Arial, sans-serif; }

    .viewport {
      width: 100%;
      overflow-x: auto;   /* allow scroll if absolutely needed */
    }
    .viewport { width:100%; overflow-x:auto; }

    h2 {
      margin: 0 0 12px 0;
      font-size: 18px;
      font-weight: 700;
      text-align: center;
    }
    h2 { margin:12px 0; font-size:18px; font-weight:700; text-align:center; }

    /* Responsive table */
    table {
      border-collapse: collapse;
      width: 100%;            /* stretch to iframe width */
      table-layout: auto;     /* let columns adjust */
    }

    table { border-collapse:collapse; width:100%; table-layout:auto; }
    th, td {
      border: 1px solid #000;
      padding: 6px;
      text-align: center;
      font-size: 13px;
      word-break: break-word; /* wrap long hostnames instead of widening */
      border:1px solid #000;
      padding:6px;
      text-align:center;
      font-size:13px;
      word-break:break-word; /* wrap long hostnames */
    }
    thead th { background:#eee; font-weight:700; }

    thead th {
      background: #eee;
      font-weight: bold;
    }
    /* Status strip */
    .status { margin-top:10px; padding:10px; text-align:center; color:#fff; font-weight:700; font-size:14px; }
    .ok  { background:#00a651; }
    .bad { background:#d50000; }

    .status {
      margin-top: 10px;
      padding: 10px;
      text-align: center;
      color: #fff;
      font-weight: 700;
      font-size: 14px;
    }
    .ok  { background: #00a651; }
    .bad { background: #d50000; }
    /* Details of mismatches (red text) */
    .details { margin-top:6px; text-align:center; font-size:13px; color:#d50000; }
    .hide { display:none; }

    /* Highlight actual values that are wrong */
    .bad-text { color:#d50000; font-weight:700; }
  </style>
</head>
<body>
  <div class="viewport">
    <h2 id="domain">DNS Record Confirmation</h2>

    <table>
      <thead>
        <tr>
@@ -87,7 +67,9 @@ <h2 id="domain">DNS Record Confirmation</h2>
        </tr>
      </tbody>
    </table>

    <div id="status" class="status">Checking DNSâ€¦</div>
    <div id="details" class="details hide"></div>
  </div>

  <script>
@@ -104,37 +86,60 @@ <h2 id="domain">DNS Record Confirmation</h2>
    document.getElementById('cnameHostCell').textContent = cnameHost;
    document.getElementById('actCnameHost').textContent  = cnameHost;

    /* --- Cloudflare DNS over HTTPS --- */
    /* --- Cloudflare DNS-over-HTTPS --- */
    async function doh(name, type) {
      const url = `https://cloudflare-dns.com/dns-query?name=${encodeURIComponent(name)}&type=${type}`;
      const res = await fetch(url, { headers: { accept:'application/dns-json' } });
      const res = await fetch(url, { headers:{ accept:'application/dns-json' } });
      if (!res.ok) return [];
      const data = await res.json();
      return (data.Answer || []).map(a => a.data);
    }

    (async function run() {
      const statusEl = document.getElementById('status');
      const statusEl  = document.getElementById('status');
      const detailsEl = document.getElementById('details');
      const msgs = [];

      try {
        // A record
        // A record (apex)
        const aAns = await doh(domain, 'A');
        const liveA = aAns.find(v => /^\d+\.\d+\.\d+\.\d+$/.test(v)) || 'N/A';
        document.getElementById('actA').textContent = liveA;

        // CNAME record
        // CNAME (host.domain)
        const cAns = await doh(`${cnameHost}.${domain}`, 'CNAME');
        const liveC = cAns.length ? cAns[0].replace(/\.$/, '').toLowerCase() : 'N/A';
        const liveC = cAns.length ? cAns[0].replace(/\.$/,'').toLowerCase() : 'N/A';
        document.getElementById('actC').textContent = liveC;

        // Compare
        const ok = (liveA === expectedA) &&
                   (liveC !== 'N/A' && liveC === expectedC.toLowerCase());
        statusEl.textContent = ok ? 'Your DNS Records are correct'
                                  : 'Your DNS Records are NOT correct';
        // Compare (CNAME case-insensitive)
        const cnameOK = (liveC !== 'N/A') && (liveC === expectedC.toLowerCase());
        const aOK     = (liveA === expectedA);

        if (!aOK) {
          document.getElementById('actA').classList.add('bad-text');
          msgs.push(`A record mismatch: expected ${expectedA}, actual ${liveA}`);
        }
        if (!cnameOK) {
          document.getElementById('actC').classList.add('bad-text');
          msgs.push(`CNAME mismatch (${cnameHost}.${domain}): expected ${expectedC}, actual ${liveC}`);
        }

        const ok = aOK && cnameOK;
        statusEl.textContent = ok ? 'Your DNS Records are correct' : 'Your DNS Records are NOT correct';
        statusEl.className = 'status ' + (ok ? 'ok' : 'bad');

        if (msgs.length) {
          detailsEl.innerHTML = msgs.map(m => m.replace(/&/g,'&amp;').replace(/</g,'&lt;')).join('<br>');
          detailsEl.classList.remove('hide');
        } else {
          detailsEl.classList.add('hide');
          detailsEl.textContent = '';
        }
      } catch (e) {
        statusEl.textContent = 'Error checking DNS';
        statusEl.className = 'status bad';
        detailsEl.classList.add('hide');
        detailsEl.textContent = '';
      }
    })();
  </script>    // Compare A
    let aMatch = expectedA.length ? expectedA.every(ip => liveA.includes(ip)) : null;
    addRow('A', expectedA.join(', ') || '-', liveA, aMatch);

    // Compare CNAME
    let cMatch = expectedC ? liveC.includes(canon(expectedC)) : null;

    // flatten case: if no CNAME returned, compare A(host) vs A(expectedC)
    if (expectedC && cMatch === false && liveC.length === 0) {
      const hostA = (await doh(fqdn,'A')).filter(v => /^\d+\.\d+\.\d+\.\d+$/.test(v));
      const expectedCA = (await doh(expectedC,'A')).filter(v => /^\d+\.\d+\.\d+\.\d+$/.test(v));
      if (hostA.length && expectedCA.length && expectedCA.every(ip => hostA.includes(ip))) {
        cMatch = true;
      }
    }
    addRow('CNAME', expectedC || '-', liveC, cMatch);

    // Overall banner
    const checks = [aMatch, cMatch].filter(v => v !== null);
    const ok = checks.length ? checks.every(Boolean) : false;
    banner.className = 'banner ' + (ok ? 'ok' : 'fail');
    banner.textContent = ok ? "YOUR DOMAIN'S DNS RECORDS ARE CORRECT" : "YOUR DOMAIN'S DNS RECORDS ARE NOT CORRECT";

    if (debug) console.log({domain, expectedA, expectedC, cnameHost, liveA, liveC, aMatch, cMatch, ok});
  } catch (e) {
    banner.className = 'banner fail';
    banner.textContent = 'Could not fetch DNS records';
    console.error(e);
  }
})();
</script>
</body>
</html>









