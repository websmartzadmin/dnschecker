<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DNS Record Checker</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #fff;
    }

    /* wrapper that matches viewport */
    .dns-viewport {
      width: 100%;
      overflow: hidden;
    }

    /* the fixed-width table */
    .dns-root {
      width: 980px;   /* natural table width */
      margin: 0;
      transform-origin: top left;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      font-size: 14px;
    }
    th, td {
      border: 1px solid #000;
      padding: 8px;
      text-align: center;
    }
    th {
      background: #eee;
    }

    /* status bar */
    .status {
      font-weight: bold;
      color: #fff;
      text-align: center;
      padding: 10px;
    }
    .ok { background: #00a651; }
    .bad { background: #d50000; }
  </style>
</head>
<body>
  <div class="dns-viewport">
    <div class="dns-root">
      <h2 id="domain"></h2>
      <table>
        <thead>
          <tr>
            <th rowspan="2">DNS Record</th>
            <th colspan="2">Expected</th>
            <th colspan="2">Actual</th>
          </tr>
          <tr>
            <th>Value</th><th>Data</th><th>Value</th><th>Data</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>A</td>
            <td>@</td>
            <td id="expA"></td>
            <td>@</td>
            <td id="actA"></td>
          </tr>
          <tr>
            <td>CNAME</td>
            <td id="cnameHost"></td>
            <td id="expC"></td>
            <td id="actCnameHost"></td>
            <td id="actC"></td>
          </tr>
        </tbody>
      </table>
      <div id="status" class="status"></div>
    </div>
  </div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const domain = params.get("domain") || "example.com";
    const expectedA = params.get("expectedA") || "93.184.216.34";
    const expectedC = params.get("expectedC") || "example.com";
    const cnameHost = params.get("cnameHost") || "www";

    document.getElementById("domain").textContent = domain;
    document.getElementById("expA").textContent = expectedA;
    document.getElementById("expC").textContent = expectedC;
    document.getElementById("cnameHost").textContent = cnameHost;
    document.getElementById("actCnameHost").textContent = cnameHost;

    async function doh(name, type) {
      const url = `https://cloudflare-dns.com/dns-query?name=${encodeURIComponent(name)}&type=${type}`;
      const res = await fetch(url, { headers: { accept: "application/dns-json" } });
      if (!res.ok) return [];
      const data = await res.json();
      return (data.Answer || []).map(a => a.data);
    }

    (async function run() {
      try {
        // A record
        const aAns = await doh(domain, "A");
        const liveA = aAns.find(v => /^\d+\.\d+\.\d+\.\d+$/.test(v)) || "N/A";
        document.getElementById("actA").textContent = liveA;

        // CNAME
        const cAns = await doh(cnameHost + "." + domain, "CNAME");
        const liveC = cAns.length ? cAns[0].replace(/\.$/,"").toLowerCase() : "N/A";
        document.getElementById("actC").textContent = liveC;

        // Compare
        let ok = (liveA === expectedA) && (liveC === expectedC.toLowerCase());
        const statusEl = document.getElementById("status");
        statusEl.textContent = ok ? "Your DNS Records are correct" : "Your DNS Records are NOT correct";
        statusEl.className = "status " + (ok ? "ok" : "bad");
      } catch (e) {
        document.getElementById("status").textContent = "Error checking DNS";
        document.getElementById("status").className = "status bad";
      }
    })();

    // Scale table to viewport on mobile
    (function() {
      const TABLE_W = 980; // must match .dns-root width
      function fit() {
        const vw = Math.min(window.innerWidth, document.documentElement.clientWidth || TABLE_W);
        const scale = Math.min(1, vw / TABLE_W);
        const root = document.querySelector('.dns-root');
        const vp   = document.querySelector('.dns-viewport');
        root.style.transform = `scale(${scale})`;
        vp.style.height = root.getBoundingClientRect().height + "px";
      }
      window.addEventListener('load', fit);
      window.addEventListener('resize', fit);
    })();
  </script>
</body>
</html>



